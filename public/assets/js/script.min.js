$(document).ready(function () { $(document).on("click", ".create-btn", function () { let t = $('meta[name="csrf-token"]').attr("content"), a = $(this).attr("route"); axios.get(a, { headers: { "Content-Type": "application/json", "X-CSRF-Token": t } }).then(t => { $(".main_modal").modal("show"), $(".main_modal .modal-dialog").html(""), $(".main_modal .modal-dialog").html(t.data) }).catch(t => { console.log(t) }) }), $(".main_modal").on("click", "#send_form", function () { var t; let a = $(this).attr("route"), e = $(this).attr("form"), o = $(this).attr("table"), n; if (t = e, n = !0, $(`#${t} .form_element`).each(function () { let t = $(this); $(`#error_${$(this).attr("id")}`).text(""), t.removeClass("is-invalid"), ("" == t.val() || void 0 == t.val()) && t.attr("required") ? (t.addClass("is-invalid"), n = !1) : t.addClass("is-valid") }), n) { let l = $('meta[name="csrf-token"]').attr("content"), s = new FormData($(`#${e}`)[0]); $("#send_form").prop("disabled", !0), axios.post(a, s, { headers: { "Content-Type": "multipart/form-data", "X-CSRF-Token": l } }).then(({ data: t }) => { t.ok && ($(".modal").modal("hide"), $(`#${o}`).DataTable().ajax.reload()), Toastify({ text: t.message, className: "bg-" + t.type }).showToast() }).catch(({ response: t }) => { console.log(t), t.data.errors ? function t(a) { Object.keys(a).forEach(function (t) { let e = t, o = a[t]; $(`#${e}`).removeClass("is-ivalid"), $(`#${e}`).addClass("is-invalid"), $(`#error_${e}`).text(o) }) }(t.data.errors) : ($(".modal").modal("hide"), Toastify({ text: "somthing went wrong !!", className: "bg-danger" }).showToast()) }).finally(() => { $("#send_form").prop("disabled", !1) }) } }), $(document).on("click", ".edit", function () { let t = $('meta[name="csrf-token"]').attr("content"), a = $(this).attr("route"); axios.get(a, { headers: { "Content-Type": "application/json", "X-CSRF-Token": t } }).then(t => { $(".main_modal").modal("show"), $(".main_modal .modal-dialog").html(""), $(".main_modal .modal-dialog").html(t.data) }).catch(t => { t.errors && Toastify({ text: "somthing went wrong !!", className: "danger" }).showToast(), console.log(t) }) }), $(document).on("click", ".delete", function () { let t = $('meta[name="csrf-token"]').attr("content"), a = $(this).attr("route"), e = $(this).attr("table"); axios.delete(a, { headers: { "Content-Type": "application/json", "X-CSRF-Token": t } }).then(({ data: t }) => { t.ok && $(`#${e}`).DataTable().ajax.reload(), Toastify({ text: t.message, className: "bg-" + t.type }).showToast() }).catch(({ response: t }) => { console.log(t), Toastify({ text: "somthing went wrong !!", className: "bg-danger" }).showToast() }) }) }); function useDatatable(t) { return $(`#${t.id}`).DataTable({ processing: !0, serverSide: !0, ajax: { url: t.url, type: "GET" }, columns: t.cols.map(t => ({ data: t })) }) }
